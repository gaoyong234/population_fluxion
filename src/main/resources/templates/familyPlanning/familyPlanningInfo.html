<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>计生信息</title>
    <script src="../static/plugins/jQuery/jquery-2.2.3.min.js"></script>
    <link rel="stylesheet" href="../static/plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/plugins/adminLTE/css/AdminLTE.css">
    <link rel="stylesheet" href="../static/plugins/adminLTE/css/skins/_all-skins.min.css">
    <link rel="stylesheet" href="../static/plugins/angularjs/toaster.min.css">
    <script src="../static/plugins/bootstrap/js/bootstrap.min.js"></script>

    <script src="../static/plugins/angularjs/angular.min.js"></script>
    <link rel="stylesheet" href="../static/plugins/angularjs/pagination.css">
    <script src="https://cdn.staticfile.org/angular.js/1.4.6/angular.min.js"></script>
</head>
<script>
    var app = angular.module("myApp",[]);
    app.controller("myCtrl",function ($scope,$http) {

        //验证
        $scope.verification = function(data){
            console.log(data);
            var msg = true;
            var matePeer = data.matePeer;
            var marital = data.marital;
            var maritalNumber = data.maritalNumber;
            var verify = data.verify;
            var boy = data.boy;
            var girl = data.girl;
            var policyIn = data.policyIn;
            var policyOut = data.policyOut;
            var onlyChild = data.onlyChild;
            var alimony = data.alimony;
            var contraception = data.contraception;
            var contraceptionTime = data.contraceptionTime;
            var onceBog = data.onceBog;
            var onceBirthday = data.onceBirthday;
            var oncePolicy = data.oncePolicy;
            if (matePeer==null){
                alert("请选择夫妻同行信息！！！")
                msg = false;
            }else if (marital==null){
                alert("请选择婚育证明信息！！！")
                msg = false;
            }else if (maritalNumber==null || maritalNumber == ''){
                alert("请输入婚育证编码信息！！！")
                msg = false;
            }else if (verify==null){
                alert("请选择是否验证信息！！！")
                msg = false;
            }else if (onlyChild==null){
                alert("请选择独生子女证信息！！！")
                msg = false;
            }else if (alimony==null){
                alert("请选择社会抚养费征收信息！！！")
                msg = false;
            }else if (contraception==null || contraception == ''){
                alert("请选择怀孕避孕状况信息！！！")
                msg = false;
            }else if (contraceptionTime==null || contraceptionTime == ''){
                alert("请输入措施时间信息！！！")
                msg = false;
            }else if (onceBog==null){
                alert("请选择当年生育子女信息！！！")
                msg = false;
            }else if (onceBirthday==null || onceBirthday == ''){
                alert("请输入出生日期信息！！！")
                msg = false;
            }else if (oncePolicy==null){
                alert("请选择政策外信息！！！")
                msg = false;
            }
            return msg;
        }

        $scope.obj = {};
        $scope.save = function (){
            var data = $scope.obj;
            var msg = $scope.verification(data);
            if (msg){
                $http({
                    method:"POST",
                    url:"/familyPlanning/saveFamilyPlanningInfo",
                    params:data
                }).then(function (response) {
                    if (response.data > 0){
                        alert("保存成功！");
                        location.reload();
                    }else {
                        alert("保存失败！");
                    }
                }),function errorCallback(response){

                }
            }

        }

        //查找字典表里的怀孕避孕状况信息
        $http({
            method: 'GET',
            url: '/familyMembers/findRelationshipInfo'
        }).then(function successCallback(response) {
            var contraception = []
            for (var i = 0; i <response.data.length ; i++) {
                if (response.data[i].fid == 600){
                    contraception.push(response.data[i]);
                }
            }
            $scope.contraception = contraception;
        }, function errorCallback(response) {
            // 请求失败执行代码
        });

    })
</script>
<body ng-app="myApp" ng-controller="myCtrl">
    <div align="center" style="border: 1px solid black; background-color: #00c0ef; width: 100%;height: 50px;">
        <div style="border: 1px solid black; background-color: white; width: 50%;height: 30px; margin-top: 10px;"><span style="font-size: 20px">计生信息</span></div>
    </div>
    <div>
        <table id="dataList" class="table">
           <!-- <thead>
                <tr>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>-->
            <tbody id="tbody">
                <tr>
                    <th>夫妻同行：</th>
                    <td>
                        <input type="radio" ng-model="obj.matePeer" name="matePeer" ng-value="1"/>是
                        <input type="radio" ng-model="obj.matePeer" name="matePeer" ng-value="0"/>否
                    </td>
                    <th>婚育证明：</th>
                    <td>
                        <input type="radio" ng-model="obj.marital" name="marital" ng-value="1"/>有
                        <input type="radio" ng-model="obj.marital" name="marital" ng-value="0"/>无
                    </td>
                </tr>
                <tr>
                    <th>婚育证编码：</th>
                    <td>
                        <input type="text" ng-model="obj.maritalNumber" name="maritalNumber" placeholder="请输入..."/>
                    </td>
                    <th>是否验证：</th>
                    <td>
                        <input type="radio" ng-model="obj.verify" name="verify" ng-value="1"/>是
                        <input type="radio" ng-model="obj.verify" name="verify" ng-value="0"/>否
                    </td>
                </tr>
                <tr>
                    <th>生育状况：</th>
                    <th>生育子女数：</th>
                    <td>
                        男<input type="text" style="width: 60px" ng-model="obj.boy" name="boy" placeholder="请输入..."/>人
                    </td>
                    <td>
                        女<input type="text" style="width: 60px" ng-model="obj.girl" name="girl" placeholder="请输入..."/>人
                    </td>
                </tr>
                <tr>
                    <th>政策内：</th>
                    <td>
                        <input type="radio" ng-model="obj.policyIn" name="policyIn" ng-value="0"/>2孩
                        <input type="radio" ng-model="obj.policyIn" name="policyIn" ng-value="1"/>3孩
                    </td>
                    <th>政策外：</th>
                    <td>
                        <input type="radio" ng-model="obj.policyOut" name="policyOut" ng-value="0"/>2孩
                        <input type="radio" ng-model="obj.policyOut" name="policyOut" ng-value="1"/>3孩
                    </td>
                </tr>
                <tr>
                    <th>独生子女证：</th>
                    <td>
                        <input type="radio" ng-model="obj.onlyChild" name="onlyChild" ng-value="1"/>有
                        <input type="radio" ng-model="obj.onlyChild" name="onlyChild" ng-value="0"/>无
                    </td>
                    <th>社会抚养费征收：</th>
                    <td>
                        <input type="radio" ng-model="obj.alimony" name="alimony" ng-value="1"/>已缴
                        <input type="radio" ng-model="obj.alimony" name="alimony" ng-value="0"/>未缴
                    </td>
                </tr>
                <tr>
                    <th>怀孕避孕状况：</th>
                    <td>
                        <span ng-repeat="c in contraception"><input type="radio"  ng-model="obj.contraception" name="contraception" ng-value="c.id"/>{{c.name}} </span>
                    </td>
                    <th>措施时间：</th>
                    <td>
                        <input type="date" ng-model="obj.contraceptionTime" name="contraceptionTime"/>
                    </td>
                </tr>
                <tr>
                    <th>当年生育子女：</th>
                    <td>
                        <input type="radio" ng-model="obj.onceBog" name="onceBog" ng-value="1"/>男
                        <input type="radio" ng-model="obj.onceBog" name="onceBog" ng-value="0"/>女
                    </td>
                    <th>出生日期：</th>
                    <td>
                        <input type="date" ng-model="obj.onceBirthday" name="onceBirthday"/>
                    </td>
                    <th>政策外：</th>
                    <td>
                        <input type="radio" ng-model="obj.oncePolicy" name="oncePolicy" ng-value="0"/>内
                        <input type="radio" ng-model="obj.oncePolicy" name="oncePolicy" ng-value="1"/>外
                    </td>
                </tr>
            </tbody>
        </table>
        <center>
            <button class="btn btn-success" data-toggle="modal" data-target="#chage" ng-click="save()" >保 存</button>
            <button class="btn btn-success" data-toggle="modal" data-target="#chage" ng-click="" >下一项</button>
        </center>
        <tm-pagination conf="paginationConf"></tm-pagination>
    </div>
    <div align="center" style="border: 1px solid black; background-color: #97a0b3; width: 100%;height: 50px; position: fixed;bottom: 0;">
        <div style="border: 1px solid black; background-color: white; width: 50%;height: 30px; margin-top: 10px;"><span style="font-size: 20px">版权所有：公安局</span></div>
    </div>
</body>
</html>